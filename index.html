<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>My Godot Web Game</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="preload" href="/game/godot.wasm" as="fetch" type="application/wasm" crossorigin>
  <link rel="stylesheet" href="./styles.css" />
</head>
<body>

<main class="container menu-page war" aria-labelledby="gameTitle">
  <!-- ambient decor (sparks/embers) -->
  <div class="decor" aria-hidden="true">
    <span class="paw" style="--i:0; --x:8%; --d:0s"></span>
    <span class="paw" style="--i:1; --x:22%; --d:.6s"></span>
    <span class="paw" style="--i:2; --x:40%; --d:1.2s"></span>
    <span class="paw" style="--i:3; --x:58%; --d:1.8s"></span>
    <span class="paw" style="--i:4; --x:76%; --d:2.4s"></span>
    <span class="paw" style="--i:5; --x:90%; --d:3s"></span>
  </div>

  <section class="menu-card battle focused" role="region" aria-label="Game menu">
    <header class="hero">
      <div class="logo" aria-hidden="true">
        <!-- Tactical shield + crosshair doghouse badge -->
        <svg viewBox="0 0 220 160" width="168" height="122" role="img" aria-label="Doghouse tactical badge">
          <defs>
            <linearGradient id="steel" x1="0" y1="0" x2="0" y2="1">
              <stop offset="0" stop-color="#9aa3ad"/>
              <stop offset="1" stop-color="#444b53"/>
            </linearGradient>
            <linearGradient id="danger" x1="0" y1="0" x2="1" y2="1">
              <stop offset="0" stop-color="#ef4444"/>
              <stop offset="1" stop-color="#f59e0b"/>
            </linearGradient>
          </defs>
          <g stroke="url(#danger)" stroke-width="4" opacity=".8">
            <circle cx="110" cy="80" r="58" fill="none"/>
            <path d="M20 80h60M110 20v60M140 80h60M110 110v30" />
          </g>
          <path d="M110 20 L170 46 L170 102 Q140 128 110 140 Q80 128 50 102 L50 46 Z"
                fill="url(#steel)" stroke="#0b0f14" stroke-width="3"/>
          <g transform="translate(110,86)">
            <polygon points="-45,-12 0,-42 45,-12 35,-12 35,35 -35,35 -35,-12"
                     fill="#0f1720" stroke="#0b0f14" stroke-width="3"/>
            <path d="M0,-2 a18,18 0 0 0 -18,18 v19 h36 v-19 a18,18 0 0 0 -18,-18z" fill="#ef4444"/>
          </g>
        </svg>
      </div>

      <div class="titles">
        <h1 id="gameTitle" class="title-glow">DOGHOUSE: TOWER DEFENCE</h1>
        <p class="tagline mission">Operation CATSHIELD ‚Ä¢ Hold the line ‚Ä¢ No cat left behind</p>
      </div>
    </header>

    <nav class="menu" role="menu" aria-label="Main menu">
      <button id="startBtn" class="btn lg accent tactical" role="menuitem" autofocus>
        <span class="btn-icon" aria-hidden="true">üéØ</span>
        Start Mission
      </button>

      <button id="optionsBtn" class="btn ghost outline tactical" role="menuitem" aria-haspopup="dialog" aria-controls="optionsDialog">
        <span class="btn-icon" aria-hidden="true">‚öôÔ∏è</span>
        Loadout
      </button>
      <button id="battlefieldBtn" class="btn ghost outline tactical" role="menuitem" aria-haspopup="dialog" aria-controls="battlefieldDialog">
        <span class="btn-icon" aria-hidden="true">üó∫Ô∏è</span>
        Battlefield
      </button>



      <button id="quitBtn" class="btn ghost outline tactical" role="menuitem">
        <span class="btn-icon" aria-hidden="true">‚èª</span>
        Stand Down
      </button>
    </nav>

    <div class="meta">
      <!-- Removed Last Save; keeping only Best Wave -->
      <div class="pill dogtag">BEST WAVE <span id="bestWave">0</span></div>
    </div>

    <p class="footnote intel">
      Tip: You cannot completely block the path from the enemies!
    </p>
  </section>

  <!-- existing dialog kept intact -->
  <dialog id="optionsDialog">
    <form method="dialog" class="dialog-content">
      <h2>Loadout</h2>
      <label class="row">
        <span>Mute audio</span>
        <input type="checkbox" id="optMute">
      </label>
      <label class="row">
        <span>Start in fullscreen</span>
        <input type="checkbox" id="optFullscreen" checked>
      </label>
      <label class="row">
        <span>Override grid size</span>
        <input type="checkbox" id="optGridOverride">
      </label>
      <label class="row">
        <span>Grid size</span>
        <select id="optGridSize" disabled>
          <option value="large">large ‚Äì 36√ó24</option>
          <option value="medium" selected>medium ‚Äì 30√ó20</option>
          <option value="small">small ‚Äì 24√ó16</option>
        </select>
      </label>
      <label class="row">
        <span>Starting cash</span>
        <input type="number" id="optStartingCash" min="0" value="250">
      </label>
      <menu class="dialog-actions">
        <button value="cancel" class="btn ghost">Cancel</button>
        <button id="saveOptions" value="default" class="btn tactical">Save</button>
      </menu>
    </form>
  </dialog>
  <dialog id="battlefieldDialog">
    <form method="dialog" class="dialog-content">
      <h2>Select Battlefield</h2>
      <div id="battlefieldOptions" class="maps">
        <label class="map-choice">
          <input type="radio" name="battlefield" value="backyard" checked>
          <img src="./assets/maps/backyard/backyard.png" alt="Backyard map preview">
          <span>Backyard ‚Äì Medium (30√ó20)</span>
        </label>
      </div>
      <menu class="dialog-actions">
        <button value="cancel" class="btn ghost">Cancel</button>
        <button id="saveBattlefield" value="default" class="btn tactical">Save</button>
      </menu>
    </form>
  </dialog>
</main>




  <canvas id="gameCanvas"></canvas>
  <button id="nextWaveBtn" class="btn">Next Wave</button>
  <button id="quitGameBtn" class="btn">Quit Game</button>

  <div id="hoverMenu" class="hover-menu">
    <div id="hoverMenuHeader" class="menu-header">Build Menu</div>
    <div class="tab-buttons">
      <button class="tab-btn active" data-tab="build">Build</button>
      <button class="tab-btn" data-tab="upgrade">Upgrade</button>
      <button class="tab-btn" data-tab="stats">Stats</button>
      <button class="tab-btn" data-tab="options">Options</button>
    </div>
      <div id="tab-build" class="tab-content active">
        <button id="wallBtn" class="btn sm">Wall</button>
        <button id="cannonBtn" class="btn sm">Cannon</button>
        <button id="laserBtn" class="btn sm">Laser</button>
        <div class="build-actions">
          <button id="sellBuildBtn" class="btn sm ghost">$</button>
          <button id="cancelBuildBtn" class="btn sm ghost">X</button>
        </div>
      </div>
    <div id="tab-upgrade" class="tab-content">
      <div id="selectedTowerInfo">No tower selected</div>
      <div id="upgradeOptions">
        <div id="basicUpgrades">
          <div class="upgrade-row">
            <span class="label">Damage</span>
            <span id="damageValue" class="value">-</span>
            <span id="damageNext" class="next">(+0)</span>
            <span id="damageCost" class="cost">$0</span>
            <button id="upgradeDamage" class="btn sm">+</button>
          </div>
          <div class="upgrade-row">
            <span class="label">Speed</span>
            <span id="fireRateValue" class="value">-</span>
            <span id="fireRateNext" class="next">(+0)</span>
            <span id="fireRateCost" class="cost">$0</span>
            <button id="upgradeFireRate" class="btn sm">+</button>
          </div>
          <div class="upgrade-row">
            <span class="label">Range</span>
            <span id="rangeValue" class="value">-</span>
            <span id="rangeNext" class="next">(+0)</span>
            <span id="rangeCost" class="cost">$0</span>
            <button id="upgradeRange" class="btn sm">+</button>
          </div>
        </div>
        <div id="specialUpgrades" style="display:none;">
          <div class="upgrade-row">
            <span class="label">Sniper</span>
            <span id="sniperCost" class="cost"></span>
            <button id="upgradeSniper" class="btn sm">Select</button>
          </div>
          <div class="upgrade-row">
            <span class="label">Shotgun</span>
            <span id="shotgunCost" class="cost"></span>
            <button id="upgradeShotgun" class="btn sm">Select</button>
          </div>
          <div class="upgrade-row">
            <span class="label">Dual Laser</span>
            <span id="dualLaserCost" class="cost"></span>
            <button id="upgradeDualLaser" class="btn sm">Select</button>
          </div>
          <div class="upgrade-row">
            <span class="label">Railgun</span>
            <span id="railgunCost" class="cost"></span>
            <button id="upgradeRailgun" class="btn sm">Select</button>
          </div>
        </div>
      </div>
      <button id="sellTower" class="btn">Sell</button>
    </div>
    <div id="tab-stats" class="tab-content">
      <div id="gameStats"></div>
    </div>
      <div id="tab-options" class="tab-content">
        <button id="pauseBtn" class="btn">Pause</button>
        <button id="quitInMenuBtn" class="btn">Quit</button>
      </div>
  </div>

    <div id="contextMenu" class="context-menu">
      <div id="contextStats"></div>
      <button id="contextSell" class="btn sm">$</button>
    </div>

  <script src="./main.js" defer></script>
</body>
</html>
